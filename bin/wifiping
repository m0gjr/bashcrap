#!/bin/bash

pinger(){

	i=0

	for x in {1..5}
	do
		ping -w1 -c1 $dns && ((i=i+1))
		sleep 2
	done

	echo
	echo $i
	echo

	return $i
}

endpoint=$(grep '^Endpoint' /etc/wireguard/vpn.conf | cut -d' ' -f3 | cut -d':' -f1)
router=$(ip r l $endpoint | cut -d' ' -f3)
dns=$(grep '^DNS' /etc/wireguard/vpn.conf | cut -d' ' -f3)

while true
do
	pinger && /root/bin/wifistatic
done
